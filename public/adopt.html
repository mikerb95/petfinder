<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mascotas en adopci√≥n ‚Äî Petfinder</title>
    <link rel="stylesheet" href="/assets/css/landing.css" />
    <style>
      .filters { display:flex; gap:10px; flex-wrap:wrap; margin: 12px 0 18px; }
      .filters .input { background:#fff; color:#111; border-color:#e5e7eb; }
      .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px,1fr)); gap: 14px; }
      .card { border:1px solid rgba(255,255,255,0.10); border-radius: 12px; background: rgba(255,255,255,0.04); overflow:hidden; }
      .card img { width:100%; height:180px; object-fit:cover; background:#0b1220; border-bottom:1px solid rgba(255,255,255,0.08); }
      .card .body { padding: 10px 12px; }
      .meta { color: var(--color-muted); font-size: .9rem; }
      .badge { font-size:.85rem; border:1px solid rgba(255,255,255,0.16); border-radius:999px; padding:2px 8px; margin-right:6px; }
    </style>
  </head>
  <body>
    <header class="site-header">
      <div class="container header-inner">
        <a class="brand" href="/"><span class="brand-mark">üêæ</span><span>Petfinder</span></a>
        <button id="menuToggle" class="menu-toggle" type="button">‚ò∞</button>
        <nav class="main-nav">
          <a href="/shop">Tienda</a>
          <a href="/blog">Blog</a>
          <a href="/dashboard">Dashboard</a>
        </nav>
      </div>
    </header>

    <div id="drawerBackdrop" class="drawer-backdrop" hidden></div>
    <aside id="mobileDrawer" class="mobile-drawer" aria-hidden="true">
      <header>
        <strong>Men√∫</strong>
        <button id="drawerClose" class="close" type="button" aria-label="Cerrar">Cerrar</button>
      </header>
      <nav aria-label="Men√∫ m√≥vil">
        <a href="/">Inicio</a>
        <a href="/adopt">Adopciones</a>
        <a href="/bnb">Guarder√≠a</a>
        <a href="/shop">Tienda</a>
        <a href="/blog">Blog</a>
        <a href="/dashboard">Panel</a>
      </nav>
    </aside>

    <main class="section">
      <div class="container">
        <h1>Mascotas en adopci√≥n</h1>
        <p class="hero-subtitle">Encuentra a tu nuevo compa√±ero. Filtra por ciudad y especie.</p>
        <div class="filters">
          <input id="q" class="input" placeholder="Buscar por nombre, raza o color" />
          <input id="city" class="input" placeholder="Ciudad" />
          <select id="species" class="input">
            <option value="">Especie‚Ä¶</option>
            <option value="perro">Perro</option>
            <option value="gato">Gato</option>
          </select>
          <button id="searchBtn" class="button button-primary" type="button">Buscar</button>
        </div>
        <div id="list" class="grid"></div>
      </div>
    </main>

    <footer class="site-footer">
      <div class="container footer-inner">
        <div class="footer-credit">Creado por Mike Rodr√≠guez</div>
        <nav class="footer-nav" aria-label="Footer">
          <a href="/terms">T√©rminos</a>
          <a href="/privacy">Privacidad</a>
        </nav>
      </div>
    </footer>

    <script src="/assets/js/header-user.js" defer></script>
    <script>
      (function(){
        // mobile drawer
        const toggle = document.getElementById('menuToggle');
        const drawer = document.getElementById('mobileDrawer');
        const backdrop = document.getElementById('drawerBackdrop');
        const closeBtn = document.getElementById('drawerClose');
        function open(){ document.body.classList.add('drawer-open'); drawer?.setAttribute('aria-hidden','false'); toggle?.setAttribute('aria-expanded','true'); backdrop?.removeAttribute('hidden'); }
        function close(){ document.body.classList.remove('drawer-open'); drawer?.setAttribute('aria-hidden','true'); toggle?.setAttribute('aria-expanded','false'); backdrop?.setAttribute('hidden',''); }
        toggle?.addEventListener('click', open); closeBtn?.addEventListener('click', close); backdrop?.addEventListener('click', close);

        const list = document.getElementById('list');
        const q = document.getElementById('q');
        const city = document.getElementById('city');
        const species = document.getElementById('species');
        const btn = document.getElementById('searchBtn');

        async function load(){
          const params = new URLSearchParams();
          if (q.value.trim()) params.set('q', q.value.trim());
          if (city.value.trim()) params.set('city', city.value.trim());
          if (species.value) params.set('species', species.value);
          list.innerHTML = 'Cargando‚Ä¶';
          const res = await fetch('/api/adoptions?' + params.toString());
          if (!res.ok) { list.textContent = 'Error al cargar'; return; }
          const data = await res.json();
          const arr = data.pets || [];
          if (!arr.length) { list.textContent = 'No hay mascotas en adopci√≥n a√∫n.'; return; }
          list.innerHTML = '';
          for (const p of arr) {
            const el = document.createElement('div'); el.className = 'card';
            el.innerHTML = `
              ${p.photo_url ? `<img src="${p.photo_url}" alt="${p.name}">` : ''}
              <div class="body">
                <strong>${p.name}</strong>
                <div class="meta">${p.species || ''}${p.breed ? ' ‚Ä¢ '+p.breed : ''} ‚Ä¢ ${p.city || ''}</div>
                ${p.adoption_fee_cents ? `<div><span class="badge">$${(p.adoption_fee_cents/100).toLocaleString('es-CO')} COP</span></div>` : ''}
                ${p.adoption_desc ? `<p style="margin:6px 0 0;">${p.adoption_desc}</p>` : ''}
              </div>`;
            list.appendChild(el);
          }
        }
        btn?.addEventListener('click', load);
        load();
      })();
    </script>
  </body>
</html>
